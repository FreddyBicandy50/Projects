--TABLE customer_details DATA
INSERT INTO Telecom_db.customer_details(Full_Name, Age, Gender)
VALUES ('Michael Smith', 19, 'Male');
INSERT INTO Telecom_db.customer_details(Full_Name, Age, Gender) 
VALUES('Matthew Anderson',25,'Male');
INSERT INTO Telecom_db.customer_details(Full_Name, Age, Gender)
VALUES('John Hammond',37,'Male');
INSERT INTO Telecom_db.customer_details(Full_Name, Age, Gender)
VALUES('Nicolas Milani',18,'Male');
INSERT INTO Telecom_db.customer_details(Full_Name, Age, Gender)
VALUES('Elizabeth Shelbey',65,'Female');
INSERT INTO Telecom_db.customer_details(Full_Name, Age, Gender)
VALUES('Richard Daoud',33,'Male');
INSERT INTO Telecom_db.customer_details(Full_Name, Age, Gender)
VALUES('Tiffany Andreas',21,'Male');
INSERT INTO Telecom_db.customer_details(Full_Name, Age, Gender)
VALUES('Jacob Braidy',19,'Male');
INSERT INTO Telecom_db.customer_details(Full_Name, Age, Gender)
VALUES('Christine Hourany',20,'Female');
INSERT INTO Telecom_db.customer_details(Full_Name, Age, Gender)
VALUES('Anna-Maria Sarkis',20,'Female');
INSERT INTO Telecom_db.customer_details(Full_Name, Age, Gender)
VALUES('Joelle Mazraani',23,'Female');
INSERT INTO Telecom_db.customer_details(Full_Name, Age, Gender)
VALUES('George Milani',65,'Male');
INSERT INTO Telecom_db.customer_details(Full_Name, Age, Gender)
VALUES('Raymond Al-Ashkar',55,'Male');
INSERT INTO Telecom_db.customer_details(Full_Name, Age, Gender)
VALUES('Alex Waked',45,'Male');
INSERT INTO Telecom_db.customer_details(Full_Name, Age, Gender)
VALUES('Dana Naayme',35,'Female');
INSERT INTO Telecom_db.customer_details(Full_Name, Age, Gender)
VALUES('Gabriel Bou-Mirchid',39,'Male');
INSERT INTO Telecom_db.customer_details(Full_Name, age, gender)
VALUES('Edmond Raphaelle',28,'Male');
INSERT INTO Telecom_db.customer_details(Full_Name, age, gender)
VALUES('Susan Nassour',24,'Female');
INSERT INTO Telecom_db.customer_details(Full_Name, age, gender)
VALUES('Nassir Njem',37,'Male');
INSERT INTO Telecom_db.customer_details(Full_Name, age, gender)
VALUES('Alan Dergham',52,'Male');

--TABLE numbers  
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('79-131-124',1,'prepaid',85);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('76-731-118',1,'postpaid',86);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('71-464-798',0,'prepaid',87);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('78-803-512',1,'prepaid',87);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('81-723-758',1,'postpaid',88);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('70-012-078',0,'prepaid',89);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('81-645-497',1,'prepaid',90);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('71-821-786',1,'postpaid',91);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('81-289-269',1,'postpaid',92);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('71-602-881',1,'prepaid',93);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('71-083-147',1,'prepaid',94);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('71-524-830',0,'postpaid',95);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('03-280-963',1,'prepaid',96);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('71-668-808',1,'postpaid',97);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('03-586-479',1,'postpaid',98);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('81-454-129',0,'prepaid',99);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('79-319-987',1,'postpaid',100);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('79-156-264',1,'prepaid',101);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('81-857-016',1,'prepaid',102);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('03-126-885',0,'postpaid',85);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('81-466-456',1,'postpaid',87);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('71-234-123',0,'prepaid',86);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('76-563-224',1,'postpaid',91);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('78-336-983',1,'prepaid',94);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('79-687-573',1,'postpaid',99);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('78-235-541',0,'prepaid',97);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('03-754-583',1,'postpaid',85);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('76-194-163',1,'postpaid',85);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('78-135-634',1,'prepaid',85);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('76-965-676',0,'prepaid',101);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('03-566-468',1,'postpaid',103);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('03-566-468',1,'postpaid',103);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('03-879-660',1,'postpaid',104);
INSERT INTO Telecom_db.`Numbers`(SIM_Number, Active, Type,Cust_id) VALUES('78-884-124',1,'postpaid',104);


--Table Services
    --to_date Function to convert date format 
INSERT INTO Telecom_db.Services (Name,Subscribers,Cost,date_subscribed)
VALUES('Clip Alert','71-234-123',0.5, STR_TO_DATE('05/03/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.Services (Name,Subscribers,Cost,date_subscribed)
VALUES('Clip Alert','03-566-468',0.5,STR_TO_DATE('02/8/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.Services (Name,Subscribers,Cost,date_subscribed)
VALUES('Clip Alert','78-235-541',0.5,STR_TO_DATE('30/01/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.Services (Name,Subscribers,Cost,date_subscribed)
VALUES('Clip Alert','76-965-676',0.5,STR_TO_DATE('31/05/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.Services (Name,Subscribers,Cost,date_subscribed)
VALUES('Clip Alert','78-135-634',0.5,STR_TO_DATE('06/03/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.Services (Name,Subscribers,Cost,date_subscribed)
VALUES('VIP','79-131-124',1.5,STR_TO_DATE('14/8/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.Services (Name,Subscribers,Cost,date_subscribed)
VALUES('VIP','71-234-123',1.5,STR_TO_DATE('14/01/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.Services (Name,Subscribers,Cost,date_subscribed)
VALUES('VIP','78-235-541',1.5,STR_TO_DATE('12/06/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.Services (Name,Subscribers,Cost,date_subscribed)
VALUES('VIP','81-645-497',1.5,STR_TO_DATE('31/05/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.Services (Name,Subscribers,Cost,date_subscribed)
VALUES('VIP','71-821-786',1.5,STR_TO_DATE('06/07/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.Services (Name,Subscribers,Cost,date_subscribed)
VALUES('PRIVATE','71-083-147',3.0,STR_TO_DATE('04/4/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.Services (Name,Subscribers,Cost,date_subscribed)
VALUES('PRIVATE','71-524-830',3.0,STR_TO_DATE('14/12/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.Services (Name,Subscribers,Cost,date_subscribed)
VALUES('PRIVATE','03-280-963',3.0,STR_TO_DATE('15/01/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.Services (Name,Subscribers,Cost,date_subscribed)
VALUES('PRIVATE','78-135-634',3.0,STR_TO_DATE('09/01/2023','%d/%m/%Y'));




--Table plan
INSERT INTO Telecom_db.plan (Subscribers,Plan_Name,Cost,Date_Subscribed)
VALUES('79-156-264','U-CHAT 9',9.0,STR_TO_DATE('14/04/2023' ,'%d/%m/%Y'));
INSERT INTO Telecom_db.plan (Subscribers,Plan_Name,Cost,Date_Subscribed)
VALUES('71-234-123','U-CHAT 9',9.0,STR_TO_DATE('05/10/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.plan (Subscribers,Plan_Name,Cost,Date_Subscribed)
VALUES('81-454-129','U-CHAT 9',9.0,STR_TO_DATE('09/09/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.plan (Subscribers,Plan_Name,Cost,Date_Subscribed)
VALUES('71-464-798','U-CHAT 9',9.0,STR_TO_DATE('15/07/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.plan (Subscribers,Plan_Name,Cost,Date_Subscribed)
VALUES('78-336-983','A+',15.0,STR_TO_DATE('06/07/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.plan (Subscribers,Plan_Name,Cost,Date_Subscribed)
VALUES('81-466-456','A+',15.0,STR_TO_DATE('06/07/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.plan (Subscribers,Plan_Name,Cost,Date_Subscribed)
VALUES('81-857-016','A+',15.0,STR_TO_DATE('06/07/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.plan (Subscribers,Plan_Name,Cost,Date_Subscribed)
VALUES('78-803-512','A+',15.0,STR_TO_DATE('06/07/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.plan (Subscribers,Plan_Name,Cost,Date_Subscribed)
VALUES('71-083-147','A+',15.0,STR_TO_DATE('06/07/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.plan (Subscribers,Plan_Name,Cost,Date_Subscribed)
VALUES('76-965-676','U-CHAT 17',17.0,STR_TO_DATE('06/07/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.plan (Subscribers,Plan_Name,Cost,Date_Subscribed)
VALUES('78-235-541','U-CHAT 17',17.0,STR_TO_DATE('06/07/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.plan (Subscribers,Plan_Name,Cost,Date_Subscribed)
VALUES('03-280-963','U-CHAT 17',17.0,STR_TO_DATE('06/07/2023','%d/%m/%Y'));
INSERT INTO Telecom_db.plan (Subscribers,Plan_Name,Cost,Date_Subscribed)
VALUES('71-602-881','U-CHAT 17',17.0,STR_TO_DATE('06/07/2023','%d/%m/%Y'));



--Telecom_db.Call_logs 
INSERT INTO Telecom_db.Call_logs (number_called,Start_Time,country_code,number_received,End_Time,Termination_type)
VALUES 
('03-586-479',STR_TO_DATE('10/03/2023 12:30:35','%d/%m/%Y %H:%i:%s'),'+961','71-524-830',STR_TO_DATE('10/03/2023 12:45:59','%d/%m/%Y %H:%i:%s'),404);
INSERT INTO Telecom_db.Call_logs (number_called,Start_Time,country_code,number_received,End_Time,Termination_type)
VALUES 
    ('71-821-786',STR_TO_DATE('12/03/2023 8:10:25','%d/%m/%Y %H:%i:%s'),'+961','78-135-634',STR_TO_DATE('12/03/2023 8:12:05','%d/%m/%Y %H:%i:%s'),404);
INSERT INTO Telecom_db.Call_logs (number_called,Start_Time,country_code,number_received,End_Time,Termination_type)
VALUES
    ('76-194-163',STR_TO_DATE('24/03/2023 09:30:07','%d/%m/%Y %H:%i:%s'),
    '+961','78-235-541',STR_TO_DATE('24/03/2023 09:40:55','%d/%m/%Y %H:%i:%s'),404);
INSERT INTO Telecom_db.Call_logs (number_called,Start_Time,country_code,number_received,End_Time,Termination_type)
VALUES
    ('03-754-583',STR_TO_DATE('15/03/2023 1:30:15','%d/%m/%Y %H:%i:%s'),
    '+961','71-215-568',STR_TO_DATE('15/03/2023 1:48:53','%d/%m/%Y %H:%i:%s'),101);
INSERT INTO Telecom_db.Call_logs (number_called,Start_Time,country_code,number_received,End_Time,Termination_type)
VALUES
    ('81-857-016',STR_TO_DATE('24/06/2023 2:30:15','%d/%m/%Y %H:%i:%s'),
    '+7','3-59874548',STR_TO_DATE('24/06/2023 2:44:06','%d/%m/%Y %H:%i:%s'),101);
INSERT INTO Telecom_db.Call_logs (number_called,Start_Time,country_code,number_received,End_Time,Termination_type)
VALUES
    ('79-156-264',STR_TO_DATE('05/06/2023 2:30:15','%d/%m/%Y %H:%i:%s'),
    '+1','91-59969739',STR_TO_DATE('05/06/2023 3:20:00','%d/%m/%Y %H:%i:%s'),101);
INSERT INTO Telecom_db.Call_logs (number_called,Start_Time,country_code,number_received,End_Time,Termination_type)
VALUES
    ('81-454-129',STR_TO_DATE('19/07/2023 13:45:10','%d/%m/%Y %H:%i:%s'),
    '+1','42-633-365',STR_TO_DATE('19/07/2023 14:35:10','%d/%m/%Y %H:%i:%s'),101);

--SMS/Logs
INSERT INTO Telecom_db."SMS/MMS_logs"
    (Number_sent,country_code,number_received,Sent_Date,Message_Type,Message_Size)
VALUES 
    ('71-524-830','+961','81-454-129',STR_TO_DATE('25/09/2023 10:00:00','%d/%m/%Y %H:%i:%s'),'MMS',49.0);
INSERT INTO Telecom_db."SMS/MMS_logs", 
    (Number_sent,country_code,number_received,Sent_Date,Message_Type,Message_Size)
VALUES
    ('71-083-147','+961','79-156-264',STR_TO_DATE('12/07/2023 13:45:10','%d/%m/%Y %H:%i:%s'),'SMS',0.1);
INSERT INTO Telecom_db."SMS/MMS_logs", 
    (Number_sent,country_code,number_received,Sent_Date,Message_Type,Message_Size)
VALUES
    ('03-280-963','+961','03-586-479',STR_TO_DATE('19/12/2023 21:00:10','%d/%m/%Y %H:%i:%s'),'SMS',0.5); 
INSERT INTO Telecom_db."SMS/MMS_logs", 
    (Number_sent,country_code,number_received,Sent_Date,Message_Type,Message_Size)
VALUES
    ('79-319-987','+961','70-012-078',STR_TO_DATE('18/04/2023 9:30:00','DD/MM/YYYY HH24:MI:SS'),'SMS',8.0);
INSERT INTO Telecom_db."SMS/MMS_logs", 
(Number_sent,country_code,number_received,Sent_Date,Message_Type,Message_Size)
VALUES
    ('71-821-786','+1','42-633-365',STR_TO_DATE('21/08/2023 13:45:10','DD/MM/YYYY HH24:MI:SS'),'MMS',13.5);
INSERT INTO Telecom_db."SMS/MMS_logs", 
    (Number_sent,country_code,number_received,Sent_Date,Message_Type,Message_Size)
VALUES
('81-289-269','+1','90-58848946',STR_TO_DATE('14/03/2023 07:15:00','DD/MM/YYYY HH24:MI:SS'),'MMS',68.5);
INSERT INTO Telecom_db."SMS/MMS_logs" 
    (Number_sent,country_code,number_received,Sent_Date,Message_Type,Message_Size)
VALUES
('76-965-676','+963','89-618-465',STR_TO_DATE('11/06/2023 08:10:21','DD/MM/YYYY HH24:MI:SS'),'MMS',90.5);


--Table Billings
--Define varaible for numbers
var number_check CHAR(11);
exec :number_check :='71-821-786';
INSERT INTO Billings (recharged_number,recharge_date,Total_cost)
VALUES ('71-821-786',STR_TO_DATE('21/08/2023','DD/MM/YYYY'),
    (
        --Checking if Nested query return NULL if true return 0 for calcualtions
        SELECT DISTINCT CASE WHEN 
        (
            --checking if user sent and sms or mms to calculate fees 
            SELECT
            CASE WHEN Message_Type ='SMS' 
            THEN Message_Size*0.2 
            ELSE Message_Size*1.2 END
            FROM "SMS/MMS_logs"
            WHERE  "SMS/MMS_logs".Number_sent=:number_check
        ) IS NOT NULL 
        THEN 
        (
            --if true the total cost will be returned
            SELECT
            CASE WHEN Message_Type ='SMS' 
            THEN Message_Size*0.2 
            ELSE Message_Size*1.2 END
            FROM "SMS/MMS_logs"
            WHERE  "SMS/MMS_logs".Number_sent=:number_check
        )
        ELSE 0 
        END 
        AS Total_message_cost 
        FROM "SMS/MMS_logs"
        )+
        (
            SELECT DISTINCT CASE WHEN 
                (
                    SELECT SUM(Telecom_db.Call_logs."duration")
                    FROM Telecom_db.Call_logs
                    WHERE Telecom_db.Call_logs.number_called=:number_check
                    GROUP BY Telecom_db.Call_logs.number_called
                ) IS NOT NULL 
            THEN 
                (
                    SELECT SUM(Telecom_db.Call_logs."duration")
                    FROM Telecom_db.Call_logs
                    WHERE Telecom_db.Call_logs.number_called=:number_check
                    GROUP BY Telecom_db.Call_logs.number_called
                )
            ELSE 0 
            END 
            AS Calculate_Total_Cost 
            FROM Telecom_db.Call_logs
        )+
        (
            SELECT DISTINCT CASE WHEN 
                (
                    SELECT SUM(Services.cost)
                    FROM  Services
                    WHERE Services.subscribers=:number_check
                    GROUP BY Services.subscribers
                ) IS NOT NULL 
            THEN 
                (
                    SELECT SUM(Services.cost)
                    FROM    Services
                    WHERE Services.subscribers=:number_check
                    GROUP BY Services.subscribers
                )
            ELSE 0 
            END 
            AS Total_Subs_Services_cost
            FROM Services
        )+(
            SELECT DISTINCT CASE WHEN 
                (
                    SELECT SUM(Telecom_db.plan.cost)
                    FROM    Telecom_db.plan
                    WHERE Telecom_db.plan.subscribers=:number_check
                    GROUP BY Telecom_db.plan.subscribers
                ) IS NOT NULL 
            THEN 
                (
                    SELECT SUM(Telecom_db.plan.cost)
                    FROM Telecom_db.plan
                    WHERE Telecom_db.plan.subscribers=:number_check
                    GROUP BY Telecom_db.plan.subscribers
                )
            ELSE 0 
            END 
            AS Total_plan_cost
            FROM Telecom_db.plan
        )
    );
var number_check CHAR(11);
exec :number_check :='71-234-123';
INSERT INTO Billings
    (recharged_number,recharge_date,Total_cost)
VALUES 
    ('71-234-123',STR_TO_DATE('12/06/2023','DD/MM/YYYY'),
    (
        SELECT DISTINCT CASE WHEN 
        (
            SELECT
            CASE WHEN Message_Type ='SMS' 
            THEN Message_Size*0.2 
            ELSE Message_Size*1.2 END
            FROM "SMS/MMS_logs"
            WHERE  "SMS/MMS_logs".Number_sent=:number_check
        ) IS NOT NULL 
        THEN 
        (
            SELECT
            CASE WHEN Message_Type ='SMS' 
            THEN Message_Size*0.2 
            ELSE Message_Size*1.2 END
            FROM "SMS/MMS_logs"
            WHERE  "SMS/MMS_logs".Number_sent=:number_check
        )
        ELSE 0 
        END 
        AS Total_message_cost 
        FROM "SMS/MMS_logs"
        )+
        (
            SELECT DISTINCT CASE WHEN 
                (
                    SELECT SUM(Telecom_db.Call_logs."duration")
                    FROM Telecom_db.Call_logs
                    WHERE Telecom_db.Call_logs.number_called=:number_check
                    GROUP BY Telecom_db.Call_logs.number_called
                ) IS NOT NULL 
            THEN 
                (
                    SELECT SUM(Telecom_db.Call_logs."duration")
                    FROM Telecom_db.Call_logs
                    WHERE Telecom_db.Call_logs.number_called=:number_check
                    GROUP BY Telecom_db.Call_logs.number_called
                )
            ELSE 0 
            END 
            AS Calculate_Total_Cost 
            FROM Telecom_db.Call_logs
        )+
        (
            SELECT DISTINCT CASE WHEN 
                (
                    SELECT SUM(Services.cost)
                    FROM  Services
                    WHERE Services.subscribers=:number_check
                    GROUP BY Services.subscribers
                ) IS NOT NULL 
            THEN 
                (
                    SELECT SUM(Services.cost)
                    FROM    Services
                    WHERE Services.subscribers=:number_check
                    GROUP BY Services.subscribers
                )
            ELSE 0 
            END 
            AS Total_Subs_Services_cost
            FROM Services
        )+(
            SELECT DISTINCT CASE WHEN 
                (
                    SELECT SUM(Telecom_db.plan.cost)
                    FROM    Telecom_db.plan
                    WHERE Telecom_db.plan.subscribers=:number_check
                    GROUP BY Telecom_db.plan.subscribers
                ) IS NOT NULL 
            THEN 
                (
                    SELECT SUM(Telecom_db.plan.cost)
                    FROM Telecom_db.plan
                    WHERE Telecom_db.plan.subscribers=:number_check
                    GROUP BY Telecom_db.plan.subscribers
                )
            ELSE 0 
            END 
            AS Total_plan_cost
            FROM Telecom_db.plan
        )
    );

var number_check CHAR(11);
exec :number_check :='81-857-016';
INSERT INTO Billings
    (recharged_number,recharge_date,Total_cost)
VALUES 
    ('81-857-016',STR_TO_DATE('02/04/2023','DD/MM/YYYY'),
    (
        SELECT DISTINCT CASE WHEN 
        (
            SELECT
            CASE WHEN Message_Type ='SMS' 
            THEN Message_Size*0.2 
            ELSE Message_Size*1.2 END
            FROM "SMS/MMS_logs"
            WHERE  "SMS/MMS_logs".Number_sent=:number_check
        ) IS NOT NULL 
        THEN 
        (
            SELECT
            CASE WHEN Message_Type ='SMS' 
            THEN Message_Size*0.2 
            ELSE Message_Size*1.2 END
            FROM "SMS/MMS_logs"
            WHERE  "SMS/MMS_logs".Number_sent=:number_check
        )
        ELSE 0 
        END 
        AS Total_message_cost 
        FROM "SMS/MMS_logs"
        )+
        (
            SELECT DISTINCT CASE WHEN 
                (
                    SELECT SUM(Telecom_db.Call_logs."duration")
                    FROM Telecom_db.Call_logs
                    WHERE Telecom_db.Call_logs.number_called=:number_check
                    GROUP BY Telecom_db.Call_logs.number_called
                ) IS NOT NULL 
            THEN 
                (
                    SELECT SUM(Telecom_db.Call_logs."duration")
                    FROM Telecom_db.Call_logs
                    WHERE Telecom_db.Call_logs.number_called=:number_check
                    GROUP BY Telecom_db.Call_logs.number_called
                )
            ELSE 0 
            END 
            AS Calculate_Total_Cost 
            FROM Telecom_db.Call_logs
        )+
        (
            SELECT DISTINCT CASE WHEN 
                (
                    SELECT SUM(Services.cost)
                    FROM  Services
                    WHERE Services.subscribers=:number_check
                    GROUP BY Services.subscribers
                ) IS NOT NULL 
            THEN 
                (
                    SELECT SUM(Services.cost)
                    FROM    Services
                    WHERE Services.subscribers=:number_check
                    GROUP BY Services.subscribers
                )
            ELSE 0 
            END 
            AS Total_Subs_Services_cost
            FROM Services
        )+(
            SELECT DISTINCT CASE WHEN 
                (
                    SELECT SUM(Telecom_db.plan.cost)
                    FROM    Telecom_db.plan
                    WHERE Telecom_db.plan.subscribers=:number_check
                    GROUP BY Telecom_db.plan.subscribers
                ) IS NOT NULL 
            THEN 
                (
                    SELECT SUM(Telecom_db.plan.cost)
                    FROM Telecom_db.plan
                    WHERE Telecom_db.plan.subscribers=:number_check
                    GROUP BY Telecom_db.plan.subscribers
                )
            ELSE 0 
            END 
            AS Total_plan_cost
            FROM Telecom_db.plan
        )
    );

var number_check CHAR(11);
exec :number_check :='03-586-479';
INSERT INTO Billings
    (recharged_number,recharge_date,Total_cost)
VALUES 
    ('03-586-479',STR_TO_DATE('09/10/2023','DD/MM/YYYY'),
    (
        SELECT DISTINCT CASE WHEN 
        (
            SELECT
            CASE WHEN Message_Type ='SMS' 
            THEN Message_Size*0.2 
            ELSE Message_Size*1.2 END
            FROM "SMS/MMS_logs"
            WHERE  "SMS/MMS_logs".Number_sent=:number_check
        ) IS NOT NULL 
        THEN 
        (
            SELECT
            CASE WHEN Message_Type ='SMS' 
            THEN Message_Size*0.2 
            ELSE Message_Size*1.2 END
            FROM "SMS/MMS_logs"
            WHERE  "SMS/MMS_logs".Number_sent=:number_check
        )
        ELSE 0 
        END 
        AS Total_message_cost 
        FROM "SMS/MMS_logs"
        )+
        (
            SELECT DISTINCT CASE WHEN 
                (
                    SELECT SUM(Telecom_db.Call_logs."duration")
                    FROM Telecom_db.Call_logs
                    WHERE Telecom_db.Call_logs.number_called=:number_check
                    GROUP BY Telecom_db.Call_logs.number_called
                ) IS NOT NULL 
            THEN 
                (
                    SELECT SUM(Telecom_db.Call_logs."duration")
                    FROM Telecom_db.Call_logs
                    WHERE Telecom_db.Call_logs.number_called=:number_check
                    GROUP BY Telecom_db.Call_logs.number_called
                )
            ELSE 0 
            END 
            AS Calculate_Total_Cost 
            FROM Telecom_db.Call_logs
        )+
        (
            SELECT DISTINCT CASE WHEN 
                (
                    SELECT SUM(Services.cost)
                    FROM  Services
                    WHERE Services.subscribers=:number_check
                    GROUP BY Services.subscribers
                ) IS NOT NULL 
            THEN 
                (
                    SELECT SUM(Services.cost)
                    FROM    Services
                    WHERE Services.subscribers=:number_check
                    GROUP BY Services.subscribers
                )
            ELSE 0 
            END 
            AS Total_Subs_Services_cost
            FROM Services
        )+(
            SELECT DISTINCT CASE WHEN 
                (
                    SELECT SUM(Telecom_db.plan.cost)
                    FROM    Telecom_db.plan
                    WHERE Telecom_db.plan.subscribers=:number_check
                    GROUP BY Telecom_db.plan.subscribers
                ) IS NOT NULL 
            THEN 
                (
                    SELECT SUM(Telecom_db.plan.cost)
                    FROM Telecom_db.plan
                    WHERE Telecom_db.plan.subscribers=:number_check
                    GROUP BY Telecom_db.plan.subscribers
                )
            ELSE 0 
            END 
            AS Total_plan_cost
            FROM Telecom_db.plan
        )
    );

var number_check CHAR(11);
exec :number_check :='81-289-269';
INSERT INTO Billings
    (recharged_number,recharge_date,Total_cost)
VALUES 
    ('81-289-269',STR_TO_DATE('14/07/2023','DD/MM/YYYY'),
    (
        SELECT DISTINCT CASE WHEN 
        (
            SELECT
            CASE WHEN Message_Type ='SMS' 
            THEN Message_Size*0.2 
            ELSE Message_Size*1.2 END
            FROM "SMS/MMS_logs"
            WHERE  "SMS/MMS_logs".Number_sent=:number_check
        ) IS NOT NULL 
        THEN 
        (
            SELECT
            CASE WHEN Message_Type ='SMS' 
            THEN Message_Size*0.2 
            ELSE Message_Size*1.2 END
            FROM "SMS/MMS_logs"
            WHERE  "SMS/MMS_logs".Number_sent=:number_check
        )
        ELSE 0 
        END 
        AS Total_message_cost 
        FROM "SMS/MMS_logs"
        )+
        (
            SELECT DISTINCT CASE WHEN 
                (
                    SELECT SUM(Telecom_db.Call_logs."duration")
                    FROM Telecom_db.Call_logs
                    WHERE Telecom_db.Call_logs.number_called=:number_check
                    GROUP BY Telecom_db.Call_logs.number_called
                ) IS NOT NULL 
            THEN 
                (
                    SELECT SUM(Telecom_db.Call_logs."duration")
                    FROM Telecom_db.Call_logs
                    WHERE Telecom_db.Call_logs.number_called=:number_check
                    GROUP BY Telecom_db.Call_logs.number_called
                )
            ELSE 0 
            END 
            AS Calculate_Total_Cost 
            FROM Telecom_db.Call_logs
        )+
        (
            SELECT DISTINCT CASE WHEN 
                (
                    SELECT SUM(Services.cost)
                    FROM  Services
                    WHERE Services.subscribers=:number_check
                    GROUP BY Services.subscribers
                ) IS NOT NULL 
            THEN 
                (
                    SELECT SUM(Services.cost)
                    FROM    Services
                    WHERE Services.subscribers=:number_check
                    GROUP BY Services.subscribers
                )
            ELSE 0 
            END 
            AS Total_Subs_Services_cost
            FROM Services
        )+(
            SELECT DISTINCT CASE WHEN 
                (
                    SELECT SUM(Telecom_db.plan.cost)
                    FROM    Telecom_db.plan
                    WHERE Telecom_db.plan.subscribers=:number_check
                    GROUP BY Telecom_db.plan.subscribers
                ) IS NOT NULL 
            THEN 
                (
                    SELECT SUM(Telecom_db.plan.cost)
                    FROM Telecom_db.plan
                    WHERE Telecom_db.plan.subscribers=:number_check
                    GROUP BY Telecom_db.plan.subscribers
                )
            ELSE 0 
            END 
            AS Total_plan_cost
            FROM Telecom_db.plan
        )
    );

var number_check CHAR(11);
exec :number_check :='71-083-147';
INSERT INTO Billings
    (recharged_number,recharge_date,Total_cost)
VALUES 
    ('71-083-147',STR_TO_DATE('29/01/2023','DD/MM/YYYY'),
    (
        SELECT DISTINCT CASE WHEN 
        (
            SELECT
            CASE WHEN Message_Type ='SMS' 
            THEN Message_Size*0.2 
            ELSE Message_Size*1.2 END
            FROM "SMS/MMS_logs"
            WHERE  "SMS/MMS_logs".Number_sent=:number_check
        ) IS NOT NULL 
        THEN 
        (
            SELECT
            CASE WHEN Message_Type ='SMS' 
            THEN Message_Size*0.2 
            ELSE Message_Size*1.2 END
            FROM "SMS/MMS_logs"
            WHERE  "SMS/MMS_logs".Number_sent=:number_check
        )
        ELSE 0 
        END 
        AS Total_message_cost 
        FROM "SMS/MMS_logs"
        )+
        (
            SELECT DISTINCT CASE WHEN 
                (
                    SELECT SUM(Telecom_db.Call_logs."duration")
                    FROM Telecom_db.Call_logs
                    WHERE Telecom_db.Call_logs.number_called=:number_check
                    GROUP BY Telecom_db.Call_logs.number_called
                ) IS NOT NULL 
            THEN 
                (
                    SELECT SUM(Telecom_db.Call_logs."duration")
                    FROM Telecom_db.Call_logs
                    WHERE Telecom_db.Call_logs.number_called=:number_check
                    GROUP BY Telecom_db.Call_logs.number_called
                )
            ELSE 0 
            END 
            AS Calculate_Total_Cost 
            FROM Telecom_db.Call_logs
        )+
        (
            SELECT DISTINCT CASE WHEN 
                (
                    SELECT SUM(Services.cost)
                    FROM  Services
                    WHERE Services.subscribers=:number_check
                    GROUP BY Services.subscribers
                ) IS NOT NULL 
            THEN 
                (
                    SELECT SUM(Services.cost)
                    FROM    Services
                    WHERE Services.subscribers=:number_check
                    GROUP BY Services.subscribers
                )
            ELSE 0 
            END 
            AS Total_Subs_Services_cost
            FROM Services
        )+(
            SELECT DISTINCT CASE WHEN 
                (
                    SELECT SUM(Telecom_db.plan.cost)
                    FROM    Telecom_db.plan
                    WHERE Telecom_db.plan.subscribers=:number_check
                    GROUP BY Telecom_db.plan.subscribers
                ) IS NOT NULL 
            THEN 
                (
                    SELECT SUM(Telecom_db.plan.cost)
                    FROM Telecom_db.plan
                    WHERE Telecom_db.plan.subscribers=:number_check
                    GROUP BY Telecom_db.plan.subscribers
                )
            ELSE 0 
            END 
            AS Total_plan_cost
            FROM Telecom_db.plan
        )
    );

SELECT * FROM "SMS/MMS_logs";